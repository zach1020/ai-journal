<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Journal - Your Digital Diary</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1 class="app-title">
                    <i class="fas fa-book-open"></i>
                    AI Journal
                </h1>
                <button class="theme-toggle" id="themeToggle">
                    <i class="fas fa-sun"></i>
                </button>
            </div>
            
            <nav class="sidebar-nav">
                <button class="nav-item active" data-view="entries">
                    <i class="fas fa-list"></i>
                    <span>All Entries</span>
                </button>
                <button class="nav-item" data-view="new">
                    <i class="fas fa-plus"></i>
                    <span>New Entry</span>
                </button>
                <button class="nav-item" data-view="search">
                    <i class="fas fa-search"></i>
                    <span>Search</span>
                </button>
                <button class="nav-item" data-view="stats">
                    <i class="fas fa-chart-bar"></i>
                    <span>Statistics</span>
                </button>
                <button class="nav-item" data-view="trash">
                    <i class="fas fa-trash"></i>
                    <span>Trash</span>
                </button>
                <button class="nav-item" data-view="settings">
                    <i class="fas fa-cog"></i>
                    <span>Settings</span>
                </button>
            </nav>
            
            <div class="sidebar-footer">
                <div class="entry-count">
                    <span id="entryCount">0 entries</span>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Content Area -->
            <div class="content-area">
                <!-- Entries View -->
                <div class="view" id="entriesView">
                <header class="view-header">
                    <h2>Your Journal Entries</h2>
                    <div class="view-actions">
                        <button class="btn btn-danger" id="batchDeleteSelected" disabled>
                            <i class="fas fa-trash"></i>
                            Delete Selected
                        </button>
                        <button class="btn btn-primary" id="newEntryBtn">
                            <i class="fas fa-plus"></i>
                            New Entry
                        </button>
                    </div>
                </header>
                
                <div class="entries-grid" id="entriesGrid">
                    <!-- Entries will be dynamically loaded here -->
                </div>
            </div>

            <!-- New Entry View -->
            <div class="view hidden" id="newEntryView">
                <header class="view-header">
                    <h2>Write New Entry</h2>
                    <div class="view-actions">
                        <button class="btn btn-secondary" id="cancelEntryBtn">Cancel</button>
                        <button class="btn btn-primary" id="saveEntryBtn">
                            <i class="fas fa-save"></i>
                            Save Entry
                        </button>
                    </div>
                </header>
                
                <div class="entry-editor">
                    <div class="entry-header">
                        <input type="text" class="entry-title" id="entryTitle" placeholder="What's on your mind today?">
                        <div class="entry-meta">
                            <input type="date" class="entry-date" id="entryDate">
                            <input type="text" class="entry-tags" id="entryTags" placeholder="Tags (comma separated)">
                            <div class="location-input-container">
                                <input type="text" class="entry-location" id="entryLocation" placeholder="Location (e.g., New York, NY)">
                                <button type="button" class="location-btn" id="getLocationBtn" title="Use current location">
                                    <i class="fas fa-crosshairs"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="photo-upload-section">
                            <label for="photoUpload" class="photo-upload-label">
                                <i class="fas fa-camera"></i>
                                Add Photos
                            </label>
                            <input type="file" id="photoUpload" multiple accept="image/*" style="display: none;">
                            <div class="photo-preview-container" id="photoPreviewContainer"></div>
                        </div>
                    </div>
                    
                    <div class="entry-content">
                        <div class="editor-tabs">
                            <button class="tab-btn active" id="writeTab">Write</button>
                            <button class="tab-btn" id="previewTab">Preview</button>
                            <button class="tab-btn" id="insertPhotoTab">
                                <i class="fas fa-image"></i>
                                Insert Photo
                            </button>
                        </div>
                        <textarea class="entry-textarea" id="entryContent" placeholder="Start writing your thoughts... (Markdown supported)"></textarea>
                        <div class="markdown-preview hidden" id="markdownPreview"></div>
                    </div>
                </div>
            </div>

            <!-- Edit Entry View -->
            <div class="view hidden" id="editEntryView">
                <header class="view-header">
                    <h2>Edit Entry</h2>
                    <div class="view-actions">
                        <button class="btn btn-danger" id="deleteEntryBtn">
                            <i class="fas fa-trash"></i>
                            Delete
                        </button>
                        <button class="btn btn-secondary" id="cancelEditBtn">Cancel</button>
                        <button class="btn btn-primary" id="updateEntryBtn">
                            <i class="fas fa-save"></i>
                            Update Entry
                        </button>
                    </div>
                </header>
                
                <div class="entry-editor">
                    <div class="entry-header">
                        <input type="text" class="entry-title" id="editEntryTitle">
                        <div class="entry-meta">
                            <input type="date" class="entry-date" id="editEntryDate">
                            <input type="text" class="entry-tags" id="editEntryTags" placeholder="Tags (comma separated)">
                            <div class="location-input-container">
                                <input type="text" class="entry-location" id="editEntryLocation" placeholder="Location (e.g., New York, NY)">
                                <button type="button" class="location-btn" id="getEditLocationBtn" title="Use current location">
                                    <i class="fas fa-crosshairs"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="photo-upload-section">
                            <label for="editPhotoUpload" class="photo-upload-label">
                                <i class="fas fa-camera"></i>
                                Add Photos
                            </label>
                            <input type="file" id="editPhotoUpload" multiple accept="image/*" style="display: none;">
                            <div class="photo-preview-container" id="editPhotoPreviewContainer"></div>
                        </div>
                    </div>
                    
                    <div class="entry-content">
                        <div class="editor-tabs">
                            <button class="tab-btn active" id="editWriteTab">Write</button>
                            <button class="tab-btn" id="editPreviewTab">Preview</button>
                            <button class="tab-btn" id="editInsertPhotoTab">
                                <i class="fas fa-image"></i>
                                Insert Photo
                            </button>
                        </div>
                        <textarea class="entry-textarea" id="editEntryContent"></textarea>
                        <div class="markdown-preview hidden" id="editMarkdownPreview"></div>
                    </div>
                </div>
            </div>

            <!-- Search View -->
            <div class="view hidden" id="searchView">
                <header class="view-header">
                    <h2>Search Entries</h2>
                </header>
                
                <div class="search-container">
                    <div class="search-bar">
                        <i class="fas fa-search"></i>
                        <input type="text" id="searchInput" placeholder="Search your entries...">
                    </div>
                    
                    <div class="search-filters">
                        <select id="tagFilter">
                            <option value="">All Tags</option>
                        </select>
                        <input type="date" id="dateFromFilter" placeholder="From Date">
                        <input type="date" id="dateToFilter" placeholder="To Date">
                    </div>
                    
                    <div class="search-results" id="searchResults">
                        <!-- Search results will be displayed here -->
                    </div>
                </div>
            </div>

            <!-- Statistics View -->
            <div class="view hidden" id="statsView">
                <header class="view-header">
                    <h2>Your Journal Statistics</h2>
                </header>
                
                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-book"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="totalEntries">0</h3>
                            <p>Total Entries</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-calendar"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="streakDays">0</h3>
                            <p>Day Streak</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-tags"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="totalTags">0</h3>
                            <p>Unique Tags</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-words"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="totalWords">0</h3>
                            <p>Total Words</p>
                        </div>
                    </div>
                </div>
                
                <div class="charts-container">
                    <div class="chart-card">
                        <h3>Entries This Month</h3>
                        <div class="simple-chart" id="monthlyChart">
                            <!-- Simple bar chart will be created here -->
                        </div>
                    </div>
                    
                    <div class="chart-card">
                        <h3>Most Used Tags</h3>
                        <div class="tag-cloud" id="tagCloud">
                            <!-- Tag cloud will be displayed here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Trash View -->
            <div class="view hidden" id="trashView">
                <header class="view-header">
                    <h2>Deleted Entries</h2>
                    <div class="view-actions">
                        <button class="btn btn-secondary" id="clearTrashBtn">
                            <i class="fas fa-broom"></i>
                            Empty Trash
                        </button>
                    </div>
                </header>
                
                <div class="trash-container">
                    <div class="trash-info">
                        <p>Entries in trash are automatically deleted after 30 days.</p>
                    </div>
                    
                    <div class="entries-grid" id="trashGrid">
                        <!-- Deleted entries will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Settings View -->
            <div class="view hidden" id="settingsView">
                <header class="view-header">
                    <h2>Settings</h2>
                </header>
                
                <div class="settings-container">
                    <div class="settings-section">
                        <h3>AI Configuration</h3>
                        <div class="setting-item">
                            <label for="openaiApiKey">OpenAI API Key</label>
                            <div class="api-key-input">
                                <input type="password" id="openaiApiKey" placeholder="Enter your OpenAI API key">
                                <button class="btn btn-secondary" id="testApiKey">Test</button>
                            </div>
                            <p class="setting-description">
                                Your API key is stored locally and never sent to our servers. 
                                <a href="https://platform.openai.com/api-keys" target="_blank">Get your API key here</a>
                            </p>
                        </div>
                        
                        <div class="setting-item">
                            <label for="aiModel">AI Model</label>
                            <select id="aiModel">
                                <option value="gpt-3.5-turbo">GPT-3.5 Turbo (Faster, Cheaper)</option>
                                <option value="gpt-4" selected>GPT-4 (More Accurate)</option>
                                <option value="gpt-4-turbo">GPT-4 Turbo (Latest)</option>
                            </select>
                        </div>
                        
                        <div class="setting-item">
                            <button class="btn btn-primary" id="saveSettings">
                                <i class="fas fa-save"></i>
                                Save Settings
                            </button>
                        </div>
                    </div>
                    
                    <div class="settings-section">
                        <h3>Export & Backup</h3>
                        <div class="setting-item">
                            <label>Export Format</label>
                            <div class="export-options">
                                <button class="btn btn-secondary" id="exportAllPDF">
                                    <i class="fas fa-file-pdf"></i>
                                    Export All as PDF
                                </button>
                                <button class="btn btn-secondary" id="exportAllMD">
                                    <i class="fab fa-markdown"></i>
                                    Export All as Markdown
                                </button>
                            </div>
                        </div>
                        
                        <div class="setting-item">
                            <label>Selective Export</label>
                            <div class="export-options">
                                <button class="btn btn-secondary" id="exportSelectedPDF">
                                    <i class="fas fa-file-pdf"></i>
                                    Export Selected as PDF
                                </button>
                                <button class="btn btn-secondary" id="exportSelectedMD">
                                    <i class="fab fa-markdown"></i>
                                    Export Selected as Markdown
                                </button>
                            </div>
                            <p class="setting-description">
                                Go to entries view, select entries, then use these buttons to export only selected entries.
                            </p>
                        </div>
                    </div>
                    
                    <div class="settings-section">
                        <h3>AI Features</h3>
                        <div class="feature-list">
                            <div class="feature-item">
                                <i class="fas fa-list"></i>
                                <div>
                                    <h4>Entry Summarization</h4>
                                    <p>Get AI-powered summaries of your journal entries</p>
                                </div>
                            </div>
                            <div class="feature-item">
                                <i class="fas fa-tags"></i>
                                <div>
                                    <h4>Smart Tag Suggestions</h4>
                                    <p>AI suggests relevant tags based on entry content</p>
                                </div>
                            </div>
                            <div class="feature-item">
                                <i class="fas fa-lightbulb"></i>
                                <div>
                                    <h4>Writing Insights</h4>
                                    <p>Analyze patterns and themes in your journaling</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="settings-section">
                        <h3>About</h3>
                        <div class="credit-section">
                            <p class="credit-text">
                                Vibe-coded with <span class="heart">♥</span> by 
                                <a href="https://www.zachbohl.com" target="_blank" rel="noopener noreferrer">Zach Bohl</a>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            </div>
            
            <!-- AI Panel Toggle Button (Always Visible) -->
            <button class="ai-panel-toggle-floating" id="aiPanelToggleFloating">
                <i class="fas fa-robot"></i>
            </button>

            <!-- AI Panel -->
            <aside class="ai-panel" id="aiPanel">
                <div class="ai-panel-header">
                    <h3>
                        <i class="fas fa-robot"></i>
                        AI Assistant
                    </h3>
                    <button class="ai-panel-toggle" id="aiPanelToggle">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
                
                <div class="ai-panel-content">
                    <div class="ai-section">
                        <h4>Summary</h4>
                        <div class="ai-actions">
                            <button class="ai-btn" id="summarizeSelected">
                                <i class="fas fa-list"></i>
                                Summarize Selected
                            </button>
                            <button class="ai-btn" id="summarizeAll">
                                <i class="fas fa-globe"></i>
                                Summarize All
                            </button>
                        </div>
                        <div class="ai-output" id="summaryOutput">
                            <p class="ai-placeholder">Select entries to summarize or click "Summarize All"</p>
                        </div>
                    </div>
                    
                    <div class="ai-section">
                        <h4>Tag Suggestions</h4>
                        <div class="ai-actions">
                            <button class="ai-btn" id="suggestTags">
                                <i class="fas fa-tags"></i>
                                Suggest Tags
                            </button>
                        </div>
                        <div class="ai-output" id="tagOutput">
                            <p class="ai-placeholder">Click "Suggest Tags" for current entry</p>
                        </div>
                    </div>
                    
                    <div class="ai-section">
                        <h4>Insights</h4>
                        <div class="ai-actions">
                            <button class="ai-btn" id="generateInsights">
                                <i class="fas fa-lightbulb"></i>
                                Generate Insights
                            </button>
                        </div>
                        <div class="ai-output" id="insightsOutput">
                            <p class="ai-placeholder">Get AI insights about your journaling patterns</p>
                        </div>
                    </div>
                </div>
            </aside>
        </main>
    </div>

    <!-- Entry Preview Modal -->
    <div class="modal" id="entryModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle"></h3>
                <button class="modal-close" id="closeModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="modal-meta">
                    <span id="modalDate"></span>
                    <span id="modalLocation"></span>
                    <span id="modalTags"></span>
                </div>
                <div class="modal-photos" id="modalPhotos"></div>
                <div class="modal-content-text" id="modalContent"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="editModalEntry">Edit</button>
                <button class="btn btn-danger" id="deleteModalEntry">Delete</button>
            </div>
        </div>
    </div>

    <!-- Batch Delete Confirmation Modal -->
    <div class="modal" id="batchDeleteModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Confirm Batch Delete</h3>
                <button class="modal-close" id="closeBatchDeleteModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="confirmation-content">
                    <div class="warning-icon">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <p class="confirmation-text">
                        Are you sure you want to delete <span id="batchDeleteCount">0</span> selected entries?
                    </p>
                    <p class="confirmation-subtext">
                        This action cannot be undone. The entries will be moved to trash and can be restored within 30 days.
                    </p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancelBatchDelete">Cancel</button>
                <button class="btn btn-danger" id="confirmBatchDelete">
                    <i class="fas fa-trash"></i>
                    Delete Selected Entries
                </button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
